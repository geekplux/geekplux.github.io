<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  
  <title>CoffeeScript 编码风格指南（译） | GeekPlux</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="这份指南阐述了一些 CoffeeScript 的最佳实践和编码惯例。
这份指南是社群驱动的，非常鼓励大家来贡献内容。
请注意这还是一份正在完善的指南：仍有很多地方可以改进，有些已制定的准则也不一定是社区惯用的（基于此，在适当的情况下，这些有待斟酌的准则将有可能被修改或删除。）
灵感本指南中的很多细节受到了几份现有的风格指南和其他资源的启发。特别是：

PEP-8: Style Guide for">
<meta property="og:type" content="article">
<meta property="og:title" content="CoffeeScript 编码风格指南（译）">
<meta property="og:url" content="http://geekplux.com/2014/06/21/coffeescript_style_guide.html">
<meta property="og:site_name" content="GeekPlux">
<meta property="og:description" content="这份指南阐述了一些 CoffeeScript 的最佳实践和编码惯例。
这份指南是社群驱动的，非常鼓励大家来贡献内容。
请注意这还是一份正在完善的指南：仍有很多地方可以改进，有些已制定的准则也不一定是社区惯用的（基于此，在适当的情况下，这些有待斟酌的准则将有可能被修改或删除。）
灵感本指南中的很多细节受到了几份现有的风格指南和其他资源的启发。特别是：

PEP-8: Style Guide for">
<meta property="og:updated_time" content="2015-01-04T11:41:59.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="CoffeeScript 编码风格指南（译）">
<meta name="twitter:description" content="这份指南阐述了一些 CoffeeScript 的最佳实践和编码惯例。
这份指南是社群驱动的，非常鼓励大家来贡献内容。
请注意这还是一份正在完善的指南：仍有很多地方可以改进，有些已制定的准则也不一定是社区惯用的（基于此，在适当的情况下，这些有待斟酌的准则将有可能被修改或删除。）
灵感本指南中的很多细节受到了几份现有的风格指南和其他资源的启发。特别是：

PEP-8: Style Guide for">
<meta name="twitter:creator" content="@GeekPlux">
  
    <link rel="alternate" href="/atom.xml" title="GeekPlux" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  <link rel="stylesheet" href="/css/typing.css">
</head>

  
    <body>
  
      <div id="container" class="container">
        <article id="post-coffeescript_style_guide" class="article article-type-post" itemscope itemprop="blogPost">
  <header id="header" class="header">
  <nav id="main-nav" class="main-nav">
    
      <a class="main-nav-link" href="/">Home</a>
    
      <a class="main-nav-link" href="/archives">Archives</a>
    
      <a class="main-nav-link" href="/wiki">Wiki</a>
    
      <a class="main-nav-link" href="/about">About</a>
    
      <a class="main-nav-link" href="/gab">扯淡集</a>
    
  </nav>
  <nav id="sub-nav">
    
      <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
    
  </nav>
</header>

  <hr/>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      CoffeeScript 编码风格指南（译）
    </h1>
  

      </header>
    
    <div class="article-entry typo" itemprop="articleBody">
      
        <p>这份指南阐述了一些 <a href="http://jashkenas.github.com/coffee-script/" target="_blank" rel="external">CoffeeScript</a> 的最佳实践和编码惯例。</p>
<p>这份指南是社群驱动的，非常鼓励大家来贡献内容。</p>
<p>请注意这还是一份正在完善的指南：仍有很多地方可以改进，有些已制定的准则也不一定是社区惯用的（基于此，在适当的情况下，这些有待斟酌的准则将有可能被修改或删除。）</p>
<h2 id="灵感"><a href="#灵感" class="headerlink" title="灵感"></a>灵感</h2><p>本指南中的很多细节受到了几份现有的风格指南和其他资源的启发。特别是：</p>
<ul>
<li><a href="http://www.python.org/dev/peps/pep-0008/" target="_blank" rel="external">PEP-8</a>: Style Guide for Python Code</li>
<li>Bozhidar Batsov’s <a href="https://github.com/bbatsov/ruby-style-guide" target="_blank" rel="external">Ruby Style Guide</a></li>
<li><a href="http://google-styleguide.googlecode.com/svn/trunk/javascriptguide.xml" target="_blank" rel="external">Google’s JavaScript Style Guide</a></li>
<li><a href="http://arcturo.github.com/library/coffeescript/04_idioms.html" target="_blank" rel="external">Common CoffeeScript Idioms</a></li>
<li>Thomas Reynolds’ <a href="http://awardwinningfjords.com/2011/05/13/coffeescript-specific-style-guide.html" target="_blank" rel="external">CoffeeScript-specific Style Guide</a></li>
<li>Jeremy Ashkenas’ <a href="https://gist.github.com/1005723" target="_blank" rel="external">code review</a> of <a href="http://spinejs.com/" target="_blank" rel="external">Spine</a></li>
<li>The <a href="https://github.com/jashkenas/coffee-script/wiki/FAQ" target="_blank" rel="external">CoffeeScript FAQ</a></li>
</ul>
<a id="more"></a>
<h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><ul>
<li><a href="#guide">CoffeeScript 风格指南</a><ul>
<li><a href="#code_layout">代码布局（Code Layout）</a><ul>
<li><a href="#tabs_or_spaces">Tab 还是 空格？（Tabs or Spaces?）</a></li>
<li><a href="#maximum_line_length">最大行宽（Maximum Line Length）</a></li>
<li><a href="#blank_lines">空行（Blank Lines）</a></li>
<li><a href="#trailing_whitespace">结尾空白（Trailing Whitespace）</a></li>
<li><a href="#optional_commas">可选的逗号（Optional Commas）</a></li>
<li><a href="#encoding">编码（Encoding）</a></li>
</ul>
</li>
<li><a href="#module_imports">模块导入（Module Imports）</a></li>
<li><a href="#whitespace">表达式和语句中的空白（Whitespace in Expressions and Statements）</a></li>
<li><a href="#comments">注释（Comments）</a><ul>
<li><a href="#block_comments">块注释（Block Comments）</a></li>
<li><a href="#inline_comments">行内注释（Inline Comments）</a></li>
</ul>
</li>
<li><a href="#naming_conventions">命名规范（Naming Conventions）</a></li>
<li><a href="#functions">函数（Functions）</a></li>
<li><a href="#strings">字符串（Strings）</a></li>
<li><a href="#conditionals">条件判断（Conditionals）</a></li>
<li><a href="#looping_and_comprehensions">循环和列表解析（Looping and Comprehensions）</a></li>
<li><a href="#extending_native_objects">扩展本地对象（Extending Native Objects）</a></li>
<li><a href="#exceptions">异常（Exceptions）</a></li>
<li><a href="#annotations">注解（Annotations）</a></li>
<li><a href="#miscellaneous">其他（Miscellaneous）</a></li>
</ul>
</li>
</ul>
<p><a name="code_layout"></a></p>
<h2 id="代码布局（Code-Layout）"><a href="#代码布局（Code-Layout）" class="headerlink" title="代码布局（Code Layout）"></a>代码布局（Code Layout）</h2><p><a name="tabs_or_spaces"></a></p>
<h3 id="Tab-还是-空格？（Tabs-or-Spaces-）"><a href="#Tab-还是-空格？（Tabs-or-Spaces-）" class="headerlink" title="Tab 还是 空格？（Tabs or Spaces?）"></a>Tab 还是 空格？（Tabs or Spaces?）</h3><p>只用 <strong>空格</strong>，每级缩进均为 <strong>2 个空格</strong>。切勿混用 Tab 和空格。</p>
<p><a name="maximum_line_length"></a></p>
<h3 id="最大行宽（Maximum-Line-Length）"><a href="#最大行宽（Maximum-Line-Length）" class="headerlink" title="最大行宽（Maximum Line Length）"></a>最大行宽（Maximum Line Length）</h3><p>限制每行最多 79 个字符。</p>
<p><a name="blank_lines"></a></p>
<h3 id="空行（Blank-Lines）"><a href="#空行（Blank-Lines）" class="headerlink" title="空行（Blank Lines）"></a>空行（Blank Lines）</h3><p>顶级函数和类的定义用一个空行分开。</p>
<p>类内部的函数定义也用一个空行分开。</p>
<p>对于每个函数体内，只在为了提高可读性的情况下才使用一个空行（例如：为了达到划分逻辑的目的）。</p>
<p><a name="trailing_whitespace"></a></p>
<h3 id="结尾空白（Trailing-Whitespace）"><a href="#结尾空白（Trailing-Whitespace）" class="headerlink" title="结尾空白（Trailing Whitespace）"></a>结尾空白（Trailing Whitespace）</h3><p>不要在任何一行保留行尾空白。</p>
<p><a name="optional_commas"></a></p>
<h3 id="可选的逗号（Optional-Commas）"><a href="#可选的逗号（Optional-Commas）" class="headerlink" title="可选的逗号（Optional Commas）"></a>可选的逗号（Optional Commas）</h3><p>当对象（或数组）的属性（或元素）作为单独一行列出时，避免在换行符前使用逗号。如下：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 好</span></div><div class="line">foo = [</div><div class="line">  <span class="string">'some'</span></div><div class="line">  <span class="string">'string'</span></div><div class="line">  <span class="string">'values'</span></div><div class="line">]</div><div class="line">bar:</div><div class="line">  label: <span class="string">'test'</span></div><div class="line">  value: <span class="number">87</span></div><div class="line"></div><div class="line"><span class="comment"># 差</span></div><div class="line">foo = [</div><div class="line">  <span class="string">'some'</span>,</div><div class="line">  <span class="string">'string'</span>,</div><div class="line">  <span class="string">'values'</span></div><div class="line">]</div><div class="line">bar:</div><div class="line">  label: <span class="string">'test'</span>,</div><div class="line">  value: <span class="number">87</span></div></pre></td></tr></table></figure>
<p><a name="encoding"></a></p>
<h3 id="编码（Encoding）"><a href="#编码（Encoding）" class="headerlink" title="编码（Encoding）"></a>编码（Encoding）</h3><p>UTF-8 是首选的源文件编码。</p>
<p><a name="module_imports"></a></p>
<h2 id="模块导入（Module-Imports）"><a href="#模块导入（Module-Imports）" class="headerlink" title="模块导入（Module Imports）"></a>模块导入（Module Imports）</h2><p>如果需要导入模块 (CommonJS 模块，AMD，等等.), <code>require</code> 语句应该单独作为一行。如下：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">require</span> <span class="string">'lib/setup'</span></div><div class="line">Backbone = <span class="built_in">require</span> <span class="string">'backbone'</span></div></pre></td></tr></table></figure>
<p>这些语句应该按以下顺序去分组：</p>
<ol>
<li>标准库的导入 <em>（如果标准库存在）</em></li>
<li>第三方库的导入</li>
<li>本地导入 <em>（导入这个应用程序的或库的具体依赖）</em></li>
</ol>
<p><a name="whitespace"></a></p>
<h2 id="表达式和语句中的空白（Whitespace-in-Expressions-and-Statements）"><a href="#表达式和语句中的空白（Whitespace-in-Expressions-and-Statements）" class="headerlink" title="表达式和语句中的空白（Whitespace in Expressions and Statements）"></a>表达式和语句中的空白（Whitespace in Expressions and Statements）</h2><p>下列情况应该避免多余的空格：</p>
<ul>
<li><p>紧贴着圆括号、方括号和大括号内部</p>
  <figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">($ <span class="string">'body'</span>) <span class="comment"># 好</span></div><div class="line">( $ <span class="string">'body'</span> ) <span class="comment"># 差</span></div></pre></td></tr></table></figure>
</li>
<li><p>紧贴在逗号前</p>
  <figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log x, y <span class="comment"># 好</span></div><div class="line"><span class="built_in">console</span>.log x , y <span class="comment"># 差</span></div></pre></td></tr></table></figure>
</li>
</ul>
<p>额外建议：</p>
<ul>
<li><p>在下列二元操作符的左右两边都保留 <strong>一个空格</strong></p>
<ul>
<li><p>赋值运算符: <code>=</code></p>
<ul>
<li><p><em>注意这同样适用于函数定义中的默认参数</em></p>
 <figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">test: <span class="function"><span class="params">(param = <span class="literal">null</span>)</span> -&gt;</span> <span class="comment"># 好</span></div><div class="line">test: <span class="function"><span class="params">(param=<span class="literal">null</span>)</span> -&gt;</span> <span class="comment"># 差</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>自增运算符: <code>+=</code>, <code>-=</code>, 等等。</p>
</li>
<li>比较运算符: <code>==</code>, <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code>, <code>unless</code>, 等等。</li>
<li><p>算术运算符: <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, 等等。</p>
</li>
<li><p><em>（这些操作符两边的空格不要多于一个）</em></p>
  <figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 好</span></div><div class="line">x = <span class="number">1</span></div><div class="line">y = <span class="number">1</span></div><div class="line">fooBar = <span class="number">3</span></div><div class="line"></div><div class="line"><span class="comment"># 差</span></div><div class="line">x      = <span class="number">1</span></div><div class="line">y      = <span class="number">1</span></div><div class="line">fooBar = <span class="number">3</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<p><a name="comments"></a></p>
<h2 id="注释（Comments）"><a href="#注释（Comments）" class="headerlink" title="注释（Comments）"></a>注释（Comments）</h2><p>如果你修改了一段已有注释说明的代码，则也要更新它对应的注释。（理想状态是，重构这段代码直到它不需要注释说明，然后再把之前的注释全删掉。）</p>
<p>注释的首字母要大写，除非第一个单词是以小写字母开头的标识符。</p>
<p>如果注释很短，可以省略末尾的句号。</p>
<p><a name="block_comments"></a></p>
<h3 id="块注释（Block-Comments）"><a href="#块注释（Block-Comments）" class="headerlink" title="块注释（Block Comments）"></a>块注释（Block Comments）</h3><p>注释块通常应用于尾随其后的一段代码。</p>
<p>每一行注释都以 <code>#</code> 加一个空格开头，而且和被注释的代码有相同的缩进层次。</p>
<p>注释块内的段落以仅含单个 <code>#</code> 的行分割。</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 这是一个块注释。请注意假如这是一段块注释，</span></div><div class="line"><span class="comment"># 则它描述的就应该是接下来的这段代码。</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment"># 这是块注释的第二段。</span></div><div class="line"><span class="comment"># 请注意这段是由上一行带有 # 号的空行分开的。（P.S. 最好用英文写注释）</span></div><div class="line"></div><div class="line">init()</div><div class="line">start()</div><div class="line">stop()</div></pre></td></tr></table></figure>
<p><a name="inline_comments"></a></p>
<h3 id="行内注释（Inline-Comments）"><a href="#行内注释（Inline-Comments）" class="headerlink" title="行内注释（Inline Comments）"></a>行内注释（Inline Comments）</h3><p>行内注释紧贴在被描述的代码的上一行，如果行内注释足够短，则可以处在同一行行尾（由一个空格隔开）。</p>
<p>所有行内注释都以 <code>#</code> 加一个空格开头。</p>
<p>应该限制行内注释的使用，因为它们的存在通常是一个代码异味的标志。</p>
<p>不要给显而易见的情况作行内注释：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 差</span></div><div class="line">x = x + <span class="number">1</span> <span class="comment"># x 自增</span></div></pre></td></tr></table></figure>
<p>然而，行内注释在某些情况下是有用的：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 好</span></div><div class="line">x = x + <span class="number">1</span> <span class="comment"># 边界补足</span></div></pre></td></tr></table></figure>
<p><a name="naming_conventions"></a></p>
<h2 id="命名规范（Naming-Conventions）"><a href="#命名规范（Naming-Conventions）" class="headerlink" title="命名规范（Naming Conventions）"></a>命名规范（Naming Conventions）</h2><p>使用 <code>小驼峰命名法</code> （第一个词的首字母小写，后面每个词的首字母大写）来命名所有的变量、方法和对象属性。</p>
<p>使用 <code>大驼峰命名法</code> （第一个词的首字母，以及后面每个词的首字母都大写）来命名所有的类 <em>（在<a href="http://en.wikipedia.org/wiki/CamelCase#Variations_and_synonyms" target="_blank" rel="external">其他类似的命名法</a>中，这种风格通常也被称为 <code>帕斯卡命名法（PascalCase）</code>、 <code>大写驼峰命名法（CamelCaps）</code> 或 <code>首字母大写命名法（CapWords）</code>。）</em></p>
<p><em>（CoffeeScript <strong>官方</strong>  约定是用驼峰命名法，因为这可以简化与 JavaScript 的相互转化，想了解更多，请看<a href="https://github.com/jashkenas/coffee-script/issues/425" target="_blank" rel="external">这里</a>.)</em></p>
<p>对于常量，单词全部大写，用下划线隔开即可：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">CONSTANT_LIKE_THIS</div></pre></td></tr></table></figure>
<p>私有函数和私有变量都应该在前面加一个下划线：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">_privateMethod: <span class="function">-&gt;</span></div></pre></td></tr></table></figure>
<p><a name="functions"></a></p>
<h2 id="函数（Functions）"><a href="#函数（Functions）" class="headerlink" title="函数（Functions）"></a>函数（Functions）</h2><p><em>（以下这些准则同样适用于类中的方法。）</em></p>
<p>当声明一个带参函数时，应在参数列表的右圆括号后空出一个空格：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="title">foo</span> = <span class="params">(arg1, arg2)</span> -&gt;</span> <span class="comment"># 好</span></div><div class="line"><span class="function"><span class="title">foo</span> = <span class="params">(arg1, arg2)</span>-&gt;</span> <span class="comment"># 差</span></div></pre></td></tr></table></figure>
<p>无参函数不要用圆括号：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="title">bar</span> = -&gt;</span> <span class="comment"># 好</span></div><div class="line"><span class="function"><span class="title">bar</span> = <span class="params">()</span> -&gt;</span> <span class="comment"># 差</span></div></pre></td></tr></table></figure>
<p>当函数链式调用，却在一行放不下时，则把每个函数调用都另起一行，且都缩进一级（即在 <code>.</code> 前加两个空格）。</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[<span class="number">1.</span><span class="number">.3</span>]</div><div class="line">  .map(<span class="function"><span class="params">(x)</span> -&gt;</span> x * x)</div><div class="line">  .concat([<span class="number">10.</span><span class="number">.12</span>])</div><div class="line">  .filter(<span class="function"><span class="params">(x)</span> -&gt;</span> x &lt; <span class="number">11</span>)</div><div class="line">  .reduce(<span class="function"><span class="params">(x, y)</span> -&gt;</span> x + y)</div></pre></td></tr></table></figure>
<p>当调用函数时，我们应该为了提高可读性而去掉圆括号。请记住，「可读性」是我们主观臆断的。只有类似下面几个例子的情况才被社区认为是最佳的：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">baz <span class="number">12</span></div><div class="line"></div><div class="line">brush.ellipse x: <span class="number">10</span>, y: <span class="number">20</span> <span class="comment"># 大括号在适当的时候也可以去掉</span></div><div class="line"></div><div class="line">foo(<span class="number">4</span>).bar(<span class="number">8</span>)</div><div class="line"></div><div class="line">obj.value(<span class="number">10</span>, <span class="number">20</span>) / obj.value(<span class="number">20</span>, <span class="number">10</span>)</div><div class="line"></div><div class="line"><span class="built_in">print</span> inspect value</div><div class="line"></div><div class="line"><span class="keyword">new</span> Tag(<span class="keyword">new</span> Value(a, b), <span class="keyword">new</span> Arg(c))</div></pre></td></tr></table></figure>
<p>有时候你会发现圆括号用来包裹的是函数体（而不是函数的参数）。请看下面的例子（以下简称为「函数体风格」）：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">($ <span class="string">'#selektor'</span>).addClass <span class="string">'klass'</span></div><div class="line"></div><div class="line">(foo <span class="number">4</span>).bar <span class="number">8</span></div></pre></td></tr></table></figure>
<p>这段代码会编译为：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$(<span class="string">'#selektor'</span>).addClass <span class="string">'klass'</span></div><div class="line"></div><div class="line">foo(<span class="number">4</span>).bar <span class="number">8</span></div></pre></td></tr></table></figure>
<p>一些习惯链式调用的人会巧用「函数体风格」进行单独初始化：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">($ <span class="string">'#selektor'</span>).addClass(<span class="string">'klass'</span>).hide() <span class="comment"># 单独初始化调用</span></div><div class="line">(($ <span class="string">'#selektor'</span>).addClass <span class="string">'klass'</span>).hide() <span class="comment"># 全部调用</span></div></pre></td></tr></table></figure>
<p>「函数体风格」并不得到推荐。但是， <strong>当它适应一些特殊的项目需求时，还是得用它。</strong></p>
<p><a name="strings"></a></p>
<h2 id="字符串（Strings）"><a href="#字符串（Strings）" class="headerlink" title="字符串（Strings）"></a>字符串（Strings）</h2><p>用字符串插值代替字符串连接符：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="string">"this is an <span class="subst">#&#123;adjective&#125;</span> string"</span> <span class="comment"># 好</span></div><div class="line"><span class="string">"this is an "</span> + adjective + <span class="string">" string"</span> <span class="comment"># 差</span></div></pre></td></tr></table></figure>
<p>最好用单引号 (<code>&#39;&#39;</code>) 而不是双引号 (<code>&quot;&quot;</code>) 。除非是插入到另一段现有的字符串中（类似字符串插值）。</p>
<p><a name="conditionals"></a></p>
<h2 id="条件判断（Conditionals）"><a href="#条件判断（Conditionals）" class="headerlink" title="条件判断（Conditionals）"></a>条件判断（Conditionals）</h2><p>用 <code>unless</code> 来代替 <code>if</code> 的否定情况。</p>
<p>不要用 <code>unless...else</code>， 而用 <code>if...else</code>:</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 好</span></div><div class="line"><span class="keyword">if</span> <span class="literal">true</span></div><div class="line">  ...</div><div class="line"><span class="keyword">else</span></div><div class="line">  ...</div><div class="line"></div><div class="line"><span class="comment"># 差</span></div><div class="line"><span class="keyword">unless</span> <span class="literal">false</span></div><div class="line">  ...</div><div class="line"><span class="keyword">else</span></div><div class="line">  ...</div></pre></td></tr></table></figure>
<p>多行的 if/else 语句应该缩进：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 好</span></div><div class="line"><span class="keyword">if</span> <span class="literal">true</span></div><div class="line">  ...</div><div class="line"><span class="keyword">else</span></div><div class="line">  ...</div><div class="line"></div><div class="line"><span class="comment"># 差</span></div><div class="line"><span class="keyword">if</span> <span class="literal">true</span> <span class="keyword">then</span> ...</div><div class="line"><span class="keyword">else</span> ...</div></pre></td></tr></table></figure>
<p><a name="looping_and_comprehensions"></a></p>
<h2 id="循环和列表解析（Looping-and-Comprehensions）"><a href="#循环和列表解析（Looping-and-Comprehensions）" class="headerlink" title="循环和列表解析（Looping and Comprehensions）"></a>循环和列表解析（Looping and Comprehensions）</h2><p>尽可能的使用列表解析：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 好</span></div><div class="line">result = (item.name <span class="keyword">for</span> item <span class="keyword">in</span> array)</div><div class="line"></div><div class="line"><span class="comment"># 差</span></div><div class="line">results = []</div><div class="line"><span class="keyword">for</span> item <span class="keyword">in</span> array</div><div class="line">  results.push item.name</div></pre></td></tr></table></figure>
<p>还可以过滤结果：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">result = (item <span class="keyword">for</span> item <span class="keyword">in</span> array <span class="keyword">when</span> item.name <span class="keyword">is</span> <span class="string">"test"</span>)</div></pre></td></tr></table></figure>
<p>遍历对象的键值：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">object = one: <span class="number">1</span>, two: <span class="number">2</span></div><div class="line">alert(<span class="string">"<span class="subst">#&#123;key&#125;</span> = <span class="subst">#&#123;value&#125;</span>"</span>) <span class="keyword">for</span> key, value <span class="keyword">of</span> object</div></pre></td></tr></table></figure>
<p><a name="extending_native_objects"></a></p>
<h2 id="扩展本地对象（Extending-Native-Objects）"><a href="#扩展本地对象（Extending-Native-Objects）" class="headerlink" title="扩展本地对象（Extending Native Objects）"></a>扩展本地对象（Extending Native Objects）</h2><p>不要修改本地对象。</p>
<p>比如，不要给 <code>Array.prototype</code> 引入 <code>Array#forEach</code> 。</p>
<p><a name="exceptions"></a></p>
<h2 id="异常（Exceptions）"><a href="#异常（Exceptions）" class="headerlink" title="异常（Exceptions）"></a>异常（Exceptions）</h2><p>不要抑制异常抛出。</p>
<p><a name="annotations"></a></p>
<h2 id="注解（Annotations）"><a href="#注解（Annotations）" class="headerlink" title="注解（Annotations）"></a>注解（Annotations）</h2><p>必要的时候应该写注解，来指明接下来的代码块具体将干什么。</p>
<p>注解应紧贴在被描述代码的上一行。</p>
<p>注解关键字后面应该跟一个冒号加一个空格，加一个描述性的注释。</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># <span class="doctag">FIXME:</span> The client's current state should *not* affect payload processing.</span></div><div class="line">resetClientState()</div><div class="line">processPayload()</div></pre></td></tr></table></figure>
<p>如果注解不止一行，则下一行缩进两个空格。</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># <span class="doctag">TODO:</span> Ensure that the value returned by this call falls within a certain</span></div><div class="line"><span class="comment">#   range, or throw an exception.</span></div><div class="line">analyze()</div></pre></td></tr></table></figure>
<p>注解有以下几类：</p>
<ul>
<li><code>TODO</code>: 描述缺失的功能，以便日后加入</li>
<li><code>FIXME</code>: 描述需要修复的代码</li>
<li><code>OPTIMIZE</code>: 描述性能低下，或难以优化的代码</li>
<li><code>HACK</code>: 描述一段值得质疑（或很巧妙）的代码</li>
<li><code>REVIEW</code>: 描述需要确认其编码意图是否正确的代码</li>
</ul>
<p>如果你必须自定义一个新的注解类型，则应该把这个注解类型记录在项目的 README 里面。</p>
<p><a name="miscellaneous"></a></p>
<h2 id="其他（Miscellaneous）"><a href="#其他（Miscellaneous）" class="headerlink" title="其他（Miscellaneous）"></a>其他（Miscellaneous）</h2><p><code>and</code> 更优于 <code>&amp;&amp;</code>.</p>
<p><code>or</code> 更优于 <code>||</code>.</p>
<p><code>is</code> 更优于 <code>==</code>.</p>
<p><code>not</code> 更优于 <code>!</code>.</p>
<p><code>or=</code> 应在可能的情况下使用：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">temp <span class="keyword">or</span>= &#123;&#125; <span class="comment"># 好</span></div><div class="line">temp = temp || &#123;&#125; <span class="comment"># 差</span></div></pre></td></tr></table></figure>
<p>最好用 (<code>::</code>) 访问对象的原型：</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Array::slice <span class="comment"># 好</span></div><div class="line">Array.prototype.slice <span class="comment"># 差</span></div></pre></td></tr></table></figure>
<p>最好用 <code>@property</code> 而不是 <code>this.property</code>.</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">return</span> @property <span class="comment"># 好</span></div><div class="line"><span class="keyword">return</span> <span class="keyword">this</span>.property <span class="comment"># 差</span></div></pre></td></tr></table></figure>
<p>但是，避免使用 <strong>单独的</strong> <code>@</code>:</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">return</span> <span class="keyword">this</span> <span class="comment"># 好</span></div><div class="line"><span class="keyword">return</span> @ <span class="comment"># 差</span></div></pre></td></tr></table></figure>
<p>没有返回值的时候避免使用 <code>return</code> ，其他情况则需要显示 return 。</p>
<p>当函数需要接收可变数量的参数时，使用 splats  (<code>...</code>)。</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log args... <span class="comment"># 好</span></div><div class="line"></div><div class="line">(a, b, c, rest...) -&gt; <span class="comment"># 好</span></div></pre></td></tr></table></figure>
<p>（译文完）</p>
<hr>
<ul>
<li><a href="https://github.com/polarmobile/coffeescript-style-guide/blob/master/README.md" target="_blank" rel="external">原文地址</a></li>
<li><a href="http://geekplux.github.io/coffeescript-style-guide" target="_blank" rel="external">中文版地址</a></li>
<li><a href="https://github.com/polarmobile/coffeescript-style-guide" target="_blank" rel="external">原 Github 地址</a></li>
<li><a href="https://github.com/geekplux/coffeescript-style-guide" target="_blank" rel="external">中文版 Github 地址</a></li>
</ul>
<hr>
<p>本作品采用<a href="http://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" rel="external">知识共享 署名-非商业性使用-禁止演绎 4.0 国际 许可协议</a>进行许可。</p>

      
    </div>
    <footer class="article-footer">
      <ul class="article-meta">
        <li>
          <span class="label">Published Date:</span>
          <a href="/2014/06/21/coffeescript_style_guide.html" class="article-date">
  <time datetime="2014-06-21T15:47:32.000Z" itemprop="datePublished">2014-06-21</time>
</a>

        </li>
        
          <li>
            <span class="label">Categorie:</span>
            
  <div class="article-category">
    <a class="article-category-link" href="/categories/Web/">Web</a>/<a class="article-category-link" href="/categories/Web/CoffeeScript/">CoffeeScript</a>
  </div>


          </li>
        
        
          <li>
            <span class="label">Label:</span>
            
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CoffeeScript/">CoffeeScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Translation/">Translation</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Web/">Web</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/译文/">译文</a></li></ul>


          </li>
        
        <hr/>
      </ul>
    </footer>
  </div>
  
    
<nav id="article-nav" class="article-nav">
  
    <a href="/2014/07/06/learn_shuangpin.html" id="article-nav-newer" class="article-nav-link-wrap newer">
      <strong class="article-nav-caption">Nieuwer</strong>
      <div class="article-nav-title">
        
          双拼学习记
        
      </div>
    </a>
  
  
    <a href="/2014/05/15/coffeescript_note.html" id="article-nav-older" class="article-nav-link-wrap older">
      <strong class="article-nav-caption">Ouder</strong>
      <div class="article-nav-title">CoffeeScript 笔记</div>
    </a>
  
</nav>


  
</article>


  <section id="comments" class="comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>
  </section>



      </div>
      
    <footer id="footer" class="post-footer footer">
      <hr/>
      <div id="footerContent" class="footer-content">
        <p>I’m <strong><a href="/about">GeekPlux</a></strong>, a web developer who contributes open-source projects. You are reading my <a href="http://geekplux.com">blog</a> powered by <a href="https://hexo.io">Hexo</a> and <a href="https://github.com/geekplux/hexo-theme-typing">Typing</a>. All articles are under <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/">CC BY-NC-ND 4.0</a>. Follow me on <a href="https://twitter.com/geekplux">Twitter</a> for communicating, <a href="https://github.com/geekplux">GitHub</a> for code, and <a href="https://www.instagram.com/geekplux">Instagram</a> for daily.</p>


      </div>
    </footer>

      
  <script>
   var disqus_shortname = 'geekplux';
   
   var disqus_url = 'http://geekplux.com/2014/06/21/coffeescript_style_guide.html';
   
   (function(){
     var dsq = document.createElement('script');
     dsq.type = 'text/javascript';
     dsq.async = true;
     dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
     (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
   })();
  </script>


<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/typing.js"></script>
<!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?f3122f4261e8b3074f848be04f62f0c0";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>







    </div>
  </body>
</html>
